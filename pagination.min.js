(function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?t(require("jquery")):t(jQuery)})(function(t){"use strict";var e=function(e,n){var s={pageIndex:0,pageSize:10,total:0,pageBtnCount:11,showFirstLastBtn:!0,firstBtnText:null,firstBtnClass:"",lastBtnText:null,lastBtnClass:"",prevBtnText:"&laquo;",prevBtnClass:"",nextBtnText:"&raquo;",nextBtnClass:"",pageBtnClass:"",loadFirstPage:!0,remote:{url:null,params:null,pageParams:null,success:null,beforeSend:null,complete:null,pageIndexName:"pageIndex",pageSizeName:"pageSize",totalName:"total",traditional:!1},pageElementSort:["$page","$size","$jump","$info"],showInfo:!1,infoFormat:"{start} ~ {end} of {total} entires",noInfoText:"0 entires",showJump:!1,jumpBtnText:"Go",showPageSizes:!1,pageSizeItems:[5,10,15,20],debug:!1};this.$element=t(e),this.$page=t('<ul class="m-pagination-page"></ul>').hide(),this.$size=t('<div class="m-pagination-size"></div>').hide(),this.$jump=t('<div class="m-pagination-jump"></div>').hide(),this.$info=t('<div class="m-pagination-info"></div>').hide(),this.options=t.extend(!0,{},s,t.fn.pagination.defaults,n),n.pageElementSort?this.options.pageElementSort=n.pageElementSort:t.fn.pagination.defaults&&t.fn.pagination.defaults.pageElementSort?this.options.pageElementSort=t.fn.pagination.defaults.pageElementSort:this.options.pageElementSort=s.pageElementSort,this.options.pageSizeItems=n.pageSizeItems||(t.fn.pagination.defaults&&t.fn.pagination.defaults.pageSizeItems?t.fn.pagination.defaults.pageSizeItems:s.pageSizeItems),this.total=this.options.total,this.currentUrl=this.options.remote.url,this.currentPageIndex=i.convertInt(this.options.pageIndex),this.currentPageSize=i.convertInt(this.options.pageSize),this.currentParams=i.deserializeParams(this.options.remote.params)||{},this.getLastPageNum=function(){return a.core.calLastPageNum(this.total,this.currentPageSize)},null===this.options.remote.success&&(this.options.remote.success=this.options.remote.callback),this.init()};e.prototype={getPageIndex:function(){return this.currentPageIndex},getPageSize:function(){return this.currentPageSize},getParams:function(){return this.currentParams},setPageIndex:function(t){null!=t&&(this.currentPageIndex=i.convertInt(t))},setPageSize:function(t){null!=t&&(this.currentPageSize=i.convertInt(t))},setRemoteUrl:function(t){t&&(this.currentUrl=t)},setParams:function(t){t&&(this.currentParams=i.deserializeParams(t))},render:function(t){null!=t&&(this.total=i.convertInt(t)),this.renderPagination(),this.debug("pagination rendered")},init:function(){this.initHtml(),this.initEvent(),this.currentUrl&&this.options.loadFirstPage?this.remote():this.renderPagination(),this.debug("pagination inited")},initHtml:function(){for(var e=t('<select data-page-btn="size"></select>'),n=0;n<this.options.pageSizeItems.length;n++)e.append('<option value="'+this.options.pageSizeItems[n]+'" '+(this.currentPageSize==this.options.pageSizeItems[n]?"selected":"")+" >"+this.options.pageSizeItems[n]+"</option>");e.val(this.currentPageSize),this.$size.append(e);var a='<div class="m-pagination-group"><input data-page-btn="jump" id="jump_number_input" type="text"><button data-page-btn="jump" id="jump_number_btn" type="button">'+this.options.jumpBtnText+"</button></div>";this.$jump.append(a);var i=document.createElement("div");t(i).addClass("m-pagination-container");for(n=0;n<this.options.pageElementSort.length;n++)t(i).append(this[this.options.pageElementSort[n]]);this.$element.append(i)},initEvent:function(){this.$element.on("click",{page:this},function(e){if(t(e.target).is("button")){if("jump"==t(e.target).data("pageBtn")){var a=e.data.page.$element.find("input[data-page-btn=jump]");e.data.page.jumpEventHandler(a.val(),e)}}else void 0!==t(e.target).data("pageIndex")&&n.call(e.data.page,e)}).on("change",{page:this},function(e){var a=t(e.target);"jump"==a.data("pageBtn")&&e.data.page.jumpEventHandler(a.val(),e),"size"==a.data("pageBtn")&&n.call(e.data.page,e)}).on("keypress",{page:this},function(t){if("13"==t.keyCode){var e=t.data.page.$element.find("input[data-page-btn=jump]");t.data.page.jumpEventHandler(e.val(),t)}}),this.$element.find("input[data-page-btn=jump]").on("blur",{page:this},function(e){e.stopPropagation();var n=t(this).val();e.data.page.jumpEventHandler(t(this).val(),e),t(this).val(n)})},jumpEventHandler:function(t,e){t?a.check.checkJumpPage(t)?i.convertInt(t)>this.getLastPageNum()?this.$jump.addClass("error"):(this.$jump.removeClass("error"),n.call(this,e)):this.$jump.addClass("error"):this.$jump.removeClass("error")},doPagination:function(){this.currentUrl?this.remote():this.renderPagination()},remote:function(){if("function"==typeof this.options.remote.pageParams){var e=this.options.remote.pageParams.call(this,{pageIndex:this.currentPageIndex,pageSize:this.currentPageSize});this.currentParams=t.extend({},this.currentParams,e)}else this.currentParams[this.options.remote.pageIndexName]=this.currentPageIndex,this.currentParams[this.options.remote.pageSizeName]=this.currentPageSize;a.remote.getAjax(this,this.currentUrl,this.currentParams,this.ajaxCallBack,this.options.remote.beforeSend,this.options.remote.complete,this.options.remote.traditional)},ajaxCallBack:function(t){var e=JSON.parse(t),n=i.mapObjectNameRecursion(e,this.options.remote.totalName);if(null==n||null==n)throw new Error("the response of totalName :  '"+this.options.remote.totalName+"'  not found.");n=i.convertInt(n),this.total=n;var a=this.getLastPageNum();this.currentPageIndex>0&&a-1<this.currentPageIndex?(this.setPageIndex(a-1),this.remote()):("function"==typeof this.options.remote.success&&this.options.remote.success(e),this.renderPagination())},onEvent:function(t,e,n){null!=e&&(this.currentPageIndex=i.convertInt(e)),null!=n&&(this.currentPageSize=i.convertInt(n)),this.doPagination(),this.$element.trigger(t,{pageIndex:this.currentPageIndex,pageSize:this.currentPageSize}),this.debug("pagination "+t)},renderPagination:function(){var t={showFirstLastBtn:this.options.showFirstLastBtn,firstBtnText:this.options.firstBtnText,firstBtnClass:this.options.firstBtnClass,prevBtnText:this.options.prevBtnText,prevBtnClass:this.options.prevBtnClass,nextBtnText:this.options.nextBtnText,nextBtnClass:this.options.nextBtnClass,lastBtnText:this.options.lastBtnText,lastBtnClass:this.options.lastBtnClass,pageBtnClass:this.options.pageBtnClass},e=this.getLastPageNum();this.currentPageIndex=e>0&&this.currentPageIndex>e-1?e-1:this.currentPageIndex,this.$page.empty().append(a.core.renderPages(this.currentPageIndex,this.currentPageSize,this.total,this.options.pageBtnCount,t)).show(),this.options.showPageSizes&&0!==e?this.$size.show():this.$size.hide(),this.options.showJump&&0!==e?this.$jump.show():this.$jump.hide(),this.$info.text(a.core.renderInfo(this.currentPageIndex,this.currentPageSize,this.total,this.options.infoFormat,this.options.noInfoText)),this.options.showInfo?this.$info.show():this.$info.hide()},destroy:function(){this.$element.unbind().data("pagination",null).empty(),this.debug("pagination destroyed")},debug:function(t,e){this.options.debug&&console&&(t&&console.info(t+" : pageIndex = "+this.currentPageIndex+" , pageSize = "+this.currentPageSize+" , total = "+this.total),e&&console.info(e))}};var n=function(e){var n=e.data.page,s=t(e.target);if("click"!==e.type||void 0===s.data("pageIndex")||s.parent().hasClass("active"))if("click"!==e.type&&"keypress"!==e.type||"jump"!==s.data("pageBtn")){if("change"===e.type&&"size"===s.data("pageBtn")){var r=n.$size.find("select").val(),o=a.core.calLastPageNum(n.total,r);o>0&&n.currentPageIndex>o-1&&(n.currentPageIndex=o-1),n.onEvent(a.event.pageSizeChanged,n.currentPageIndex,r)}else if("blur"===e.type){p=n.$jump.find("input").val();i.convertInt(p)<=n.getLastPageNum()&&(n.onEvent(a.event.jumpClicked,p-1,null),n.$jump.find("input").val(null))}}else{var p=n.$jump.find("input").val();i.convertInt(p)<=n.getLastPageNum()&&(n.onEvent(a.event.jumpClicked,p-1,null),n.$jump.find("input").val(null))}else n.onEvent(a.event.pageClicked,s.data("pageIndex"),null)},a={event:{pageClicked:"pageClicked",jumpClicked:"jumpClicked",pageSizeChanged:"pageSizeChanged"}};a.remote={getAjax:function(e,n,a,i,s,r,o){t.ajax({url:n,dataType:"json",data:a,cache:!1,traditional:o,contentType:"application/Json",beforeSend:function(t){"function"==typeof s&&s.call(this,t)},complete:function(t,e){"function"==typeof r&&r.call(this,t,e)},success:function(t){i.call(e,t)}})}},a.core={renderPages:function(t,e,n,a,i){i=i||{};var s=t+1,r=this.calLastPageNum(n,e),o=[];if(r>0){o=this.renderGroupPages(s,a,r,i);var p=this.renderPerPage(i.prevBtnText,t-1,i.prevBtnClass),u=this.renderPerPage(i.nextBtnText,t+1,i.nextBtnClass,r);if(o.unshift(p),o.push(u),i.showFirstLastBtn){var l=this.renderPerPage(i.firstBtnText||1,0,i.firstBtnClass),g=this.renderPerPage(i.lastBtnText||r,r-1,i.lastBtnClass);o.unshift(l),o.push(g)}return o}},renderGroupPages:function(t,e,n,a){var i=parseInt(e/2),s=[],r=this.renderPerPage(t,t-1,a.pageBtnClass);r.addClass("active"),s.push(r);for(var o=1;o<=i;o++)t-o>=1?s.unshift(this.renderPerPage(t-o,t-(o+1),a.pageBtnClass)):t+i<n&&s.length+(i-(o-1))<e&&i++,t+o<=n?s.push(this.renderPerPage(t+o,t+(o-1),a.pageBtnClass)):t-i>0&&s.length+(i-o)<e&&i++;return e%2==0&&s.length>e&&s.shift(),s},renderPerPage:function(e,n,a,i){return n<0?this.renderDisabledPerPage(e,a):null!=i&&n==i?this.renderDisabledPerPage(e,a):t("<li><a class='"+a+"' data-page-index='"+n+"'>"+e+"</a></li>")},renderDisabledPerPage:function(e,n){return t("<li><a class='"+n+"'>"+e+"</a></li>")},renderInfo:function(t,e,n,a,i){if(n<=0)return i;var s=t*e+1,r=(t+1)*e;return r=r>=n?n:r,a.replace("{start}",s).replace("{end}",r).replace("{total}",n)},calLastPageNum:function(t,e){t=i.convertInt(t),e=i.convertInt(e);var n=t/e;return i.isDecimal(n)?parseInt(n)+1:n}},a.check={checkJumpPage:function(t){var e=/^\+?[1-9][0-9]*$/;return e.test(t)}};var i={convertInt:function(t){if("number"==typeof t)return t;var e=parseInt(t);if(isNaN(e))throw new Error("convertInt Type Error.  Type is "+typeof t+", value = "+t);return e},isDecimal:function(t){return parseInt(t)!==t},mapObjectNameRecursion:function(t,e){for(var n=t,a=e.split("."),s=0;s<a.length;s++)n=i.mapObjectName(n,a[s]);return n},mapObjectName:function(t,e){var n=null;for(var a in t)if(t.hasOwnProperty(a)&&a==e){n=t[a];break}return n},deserializeParams:function(t){var e={};if("string"==typeof t)for(var n=t.split("&"),a=0;a<n.length;a++){var i=n[a].split("=");e[i[0]]=decodeURIComponent(i[1])}else if(t instanceof Array)for(a=0;a<t.length;a++)e[t[a].name]=decodeURIComponent(t[a].value);else"object"==typeof t&&(e=t);return e}};t.fn.pagination=function(n){if(void 0===n)return t(this).data("pagination")||!1;var a,i=arguments;return this.each(function(){var s=t(this),r=s.data("pagination");if(!r&&"string"==typeof n)throw new Error("MricodePagination is uninitialized.");if(r&&"object"==typeof n)throw new Error("MricodePagination is initialized.");if(r||"object"!=typeof n)r&&"string"==typeof n&&(a=r[n].apply(r,Array.prototype.slice.call(i,1)));else{var o="object"==typeof n&&n,p=s.data();o=t.extend(o,p),s.data("pagination",r=new e(this,o))}}),void 0===a?this:a},t("#jump_number_input").on("keydown",function(e){13==e.which&&t("#jump_number_btn").trigger("click")})});